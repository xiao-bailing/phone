# 工程简介

> 调用企业微信api创建内部应用修改手机号(后端部分)

## 代码逻辑

1. 用户在前端页面填写姓名,学号,身份证,新手机号,后端接收到以后去数据库做校验,
   信息无误进行下一步,如果输入信息不正确则显示`"学号或身份证或姓名有误,请仔细检查~"`

2. 调用手机号获取userid的api校验新填写的手机号是否已经存在,如果userid已经存在,返回`填写的手机号码已存在`,如果不存在,说明已保证手机号唯一,进行下一步

3. 学号就是企业微信的userid,调用企业微信读取成员api获得用户的所有信息

4. 根据从读取成员api中获得的参数status判断用户是否激活

5. 如果已经激活企业微信,那么:

   1. 把获取的成员信息保存到数据库(此处已做判断,如果数据库存在该成员信息则不会再次添加)
   2. 调用删除成员api
   3. 调用创建成员api
   4. 如果成功创建了该成员,那么删除数据库中该成员的信息,
      修改成功前端显示`"激活企业微信用户成功修改手机号"`,否则显示`"激活企业微信用户修改手机号失败"`

   **注:该操作会导致管理员丢失权限**

6. 如果没激活企业微信,通过更新成员api修改手机号,修改成功前端页面显示`"未激活企业微信用户成功修改手机号"`,否则显示`"未激活企业微信用修改手机号失败"`

# 延伸阅读

[企业微信开发者中心](https://developer.work.weixin.qq.com/document)



